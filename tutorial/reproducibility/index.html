
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.1. Reproducibility &#8212; FM&#39;21: Tutorial</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="2.2. Consistent Code Style" href="../code-style/" />
    <link rel="prev" title="2. Best Practices" href="../best-practices/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo_with_text.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">FM'21: Tutorial</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../preparation/">
   Prepare Your System
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Tutorial
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting-started/">
   1. Getting Started
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../best-practices/">
   2. Best Practices
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.1. Reproducibility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../code-style/">
     2.2. Consistent Code Style
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../vscode-workspaces/">
     2.3. VS Code Workspaces
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../running-example/">
   3. Running Example
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model-construction/">
   4. Model Construction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../modeling-with-momba/">
     4.1. Modeling with Momba
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../model-the-game/">
     4.2. Model the Game
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference-model/">
     4.3. Reference Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model-validation/">
   5. Model Validation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../state-space-exploration/">
     5.1. State Space Exploration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../interactive-game/">
     5.2. Interactive Game
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../reference-game/">
     5.3. Reference Implementation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../model-analysis/">
   6. Model Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../takeaways/">
   7. Takeaways
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tutorial/reproducibility.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dependency-management">
   2.1.1. Dependency Management
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyproject-toml">
   2.1.2.
   <code class="docutils literal notranslate">
    <span class="pre">
     pyproject.toml
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#managing-dependencies">
   2.1.3. Managing Dependencies
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#virtual-environments">
   2.1.4. Virtual Environments
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="reproducibility">
<h1><span class="section-number">2.1. </span>Reproducibility<a class="headerlink" href="#reproducibility" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dependency-management">
<h2><span class="section-number">2.1.1. </span>Dependency Management<a class="headerlink" href="#dependency-management" title="Permalink to this headline">¶</a></h2>
<p>In academia, <em>reproducibility</em> of research is key.
An important aspect of ensuring reproducibility is to precisely capture the dependencies used by a piece of software.</p>
<p>Using a system like <a class="reference external" href="https://python-poetry.org/">Poetry</a> for dependency management has many advantages:</p>
<ul class="simple">
<li><p>The dependencies of your projects are decoupled and installed into a <em>virtual environment</em> on a per-project basis.
This prevents version conflicts between multiple projects.</p></li>
<li><p>The dependencies of your projects are precisely tracked and you can be sure that everyone in your team has the exact same versions installed reducing <em>but it works on my machine</em> moments.</p></li>
<li><p>To ensure reproducibility, you have to track the dependencies anyway.
Doing so in a well-specified format with tool support makes reproducing your experiments a breeze.</p></li>
<li><p>Your software is already in a format suitable for distribution through package managers.
In the case of Python, this is <a class="reference external" href="https://pypi.org/project/pip/">Pip</a> and the <a class="reference external" href="https://pypi.org">Python Package Index</a>.</p></li>
</ul>
<p><a class="reference external" href="https://www.python.org/dev/peps/pep-0518/">PEP 518</a> partially specifies the format of the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file.
This file defines how your project is going to be build and what dependencies in which versions are required.</p>
</div>
<div class="section" id="pyproject-toml">
<h2><span class="section-number">2.1.2. </span><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code><a class="headerlink" href="#pyproject-toml" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> contains information about your project like its <em>name</em>, a short <em>description</em>, and a list of <em>authors</em>:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poetry]</span>
<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;fmracer&quot;</span>
<span class="n">version</span> <span class="o">=</span> <span class="s">&quot;0.0.1&quot;</span>
<span class="n">description</span> <span class="o">=</span> <span class="s">&quot;A tutorial on Momba at FM21.&quot;</span>
<span class="n">authors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&quot;Maximilian Köhl &lt;koehl@cs.uni-saarland.de&gt;&quot;</span>
<span class="p">]</span>
<span class="n">license</span> <span class="o">=</span> <span class="s">&quot;MIT&quot;</span>
<span class="n">readme</span> <span class="o">=</span> <span class="s">&quot;README.md&quot;</span>
<span class="n">repository</span> <span class="o">=</span> <span class="s">&quot;https://github.com/udsdepend/fm21-momba-tutorial&quot;</span>
<span class="n">classifiers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&quot;Intended Audience :: Science/Research&quot;</span><span class="p">,</span>
    <span class="s">&quot;License :: OSI Approved :: MIT License&quot;</span><span class="p">,</span>
    <span class="s">&quot;Development Status :: 2 - Pre-Alpha&quot;</span><span class="p">,</span>
    <span class="s">&quot;Operating System :: OS Independent&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Furthermore, it contains a list of dependencies:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poetry.dependencies]</span>
<span class="c1"># required Python version</span>
<span class="n">python</span> <span class="o">=</span> <span class="s">&quot;^3.8&quot;</span>

<span class="k">[tool.poetry.dev-dependencies]</span>
<span class="n">black</span> <span class="o">=</span> <span class="p">{</span> <span class="n">version</span> <span class="o">=</span> <span class="s">&quot;^21.9b0&quot;</span><span class="p">,</span> <span class="n">allow-prereleases</span> <span class="o">=</span> <span class="n">true</span> <span class="p">}</span>
<span class="n">flake8</span> <span class="o">=</span> <span class="s">&quot;^3.7.9&quot;</span>
<span class="n">flake8-bugbear</span> <span class="o">=</span> <span class="s">&quot;^20.1.2&quot;</span>
<span class="n">pep8-naming</span> <span class="o">=</span> <span class="s">&quot;^0.9.1&quot;</span>
<span class="n">mypy</span> <span class="o">=</span> <span class="s">&quot;^0.812&quot;</span>
</pre></div>
</div>
<p>This also specifies which versions of Python are supported.
In this case, <code class="docutils literal notranslate"><span class="pre">^3.8</span></code> says that all Python versions greater or equal to <code class="docutils literal notranslate"><span class="pre">3.8</span></code> and less than <code class="docutils literal notranslate"><span class="pre">4.0</span></code> are supported.
This is very useful in case you are using features of Python only found in newer versions and you want to communicate this to users of your tool or package.
From a reproducibility perspective it prevents someone from running your project with a wrong version of Python leading to all kinds of non-obvious errors.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dev-dependencies</span></code> are dependencies which are not required for using your tool or package but for development.
In this case, we have <code class="docutils literal notranslate"><span class="pre">black</span></code>, an auto formatter, <code class="docutils literal notranslate"><span class="pre">flake8</span></code> and some related packages for linting, and <code class="docutils literal notranslate"><span class="pre">mypy</span></code>, a type checker.</p>
</div>
<div class="section" id="managing-dependencies">
<h2><span class="section-number">2.1.3. </span>Managing Dependencies<a class="headerlink" href="#managing-dependencies" title="Permalink to this headline">¶</a></h2>
<p>As you may have noticed, Momba is not yet a dependency of your project.
To add Momba as a dependency we use <code class="docutils literal notranslate"><span class="pre">poetry</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry add -E engine -E docker momba
</pre></div>
</div>
<p>This commands adds Momba as a dependency to your project.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-E</span></code> flag enables optional <em>features</em> for the package to be installed.
The <code class="docutils literal notranslate"><span class="pre">engine</span></code> feature of Momba contains the state space exploration engine we will be using for the interactive game.
The <code class="docutils literal notranslate"><span class="pre">docker</span></code> feature of Momba enables support for running Storm through Docker.</p>
<p>Running this command will add Momba as a dependency in the <code class="docutils literal notranslate"><span class="pre">dependencies</span></code> section of <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">momba</span> <span class="o">=</span> <span class="p">{</span><span class="n">version</span> <span class="o">=</span> <span class="s">&quot;^0.4.2&quot;</span><span class="p">,</span> <span class="n">extras</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;engine&quot;</span><span class="p">,</span> <span class="s">&quot;docker&quot;</span><span class="p">]}</span>
</pre></div>
</div>
<p>The caret <code class="docutils literal notranslate"><span class="pre">^</span></code> tells Poetry that we want a version of Momba that is at least <code class="docutils literal notranslate"><span class="pre">0.4.2</span></code> but less than <code class="docutils literal notranslate"><span class="pre">0.5.0</span></code>.
This is used for <a class="reference external" href="https://semver.org/">semantic versioning</a>.
Introducing breaking changes requires increasing the major version.
Hence, it documents a minimal and a maximal version.
Again, specifying a version like that enables reproducibility.</p>
<p>In addition to adding Momba to the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> the command also updated the <code class="docutils literal notranslate"><span class="pre">poetry.lock</span></code> file.
This file contains precise versions of each dependency including transitive dependencies that should be used for development and reproducing results.
It even contains cryptographic hashes of the respective dependencies to further ensure reproducibility, or, at least make it obvious, when the required file has been modified or is not available.</p>
<p>In case you are using experimental features of a dependency which are not subject to semantic versioning, it can make sense to also <em>pin</em> the version of a dependency like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">momba</span> <span class="o">=</span> <span class="p">{</span><span class="n">version</span> <span class="o">=</span> <span class="s">&quot;==0.4.2&quot;</span><span class="p">,</span> <span class="n">extras</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;engine&quot;</span><span class="p">,</span> <span class="s">&quot;docker&quot;</span><span class="p">]}</span> 
</pre></div>
</div>
<p>In case you make any manual changes to the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">poetry</span> <span class="n">lock</span>
</pre></div>
</div>
<p>to synchronize them into the <code class="docutils literal notranslate"><span class="pre">poetry.lock</span></code> file.</p>
<p>When using a version control system, you would commit the <code class="docutils literal notranslate"><span class="pre">poetry.lock</span></code> file alongside the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file.
That way, all collaborators an a project will have precisely the same dependencies in the exact versions installed.</p>
</div>
<div class="section" id="virtual-environments">
<h2><span class="section-number">2.1.4. </span>Virtual Environments<a class="headerlink" href="#virtual-environments" title="Permalink to this headline">¶</a></h2>
<p>To install a virtual environment containing all the dependencies run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry install
</pre></div>
</div>
<p>This will create a directory <code class="docutils literal notranslate"><span class="pre">.venv</span></code> containing a copy of your local Python interpreter and an installation of all and only the specified dependencies.
For reproducibility, the precise versions are taken from the <code class="docutils literal notranslate"><span class="pre">poetry.lock</span></code> file.</p>
<p>In case you are using VS Code, press <code class="docutils literal notranslate"><span class="pre">F1</span></code> to open the command palette and choose <em>Python: Select Interpreter</em>.
Then choose <em>Entire Workspace</em>.
You can now select the recommended interpreter from the virtual environment.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "udsdepend/fm21-momba-tutorial",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../best-practices/" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title"><span class="section-number">2. </span>Best Practices</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../code-style/" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title"><span class="section-number">2.2. </span>Consistent Code Style</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
            &copy; Copyright 2021, Maximilian Köhl, Saarland University.<br/>
          <div class="extra_footer">
            A tutorial co-located with <a href="http://lcs.ios.ac.cn/fm2021/">FM'21</a> organized by <a href="https://depend.cs.uni-saarland.de/~hermanns/">Holger Hermanns</a> and <a href="https://depend.cs.uni-saarland.de/~koehl/">Maximilian Köhl</a>.
<br>
<a href="https://www.uni-saarland.de/impressum.html">Imprint</a>
| Hosted by <a href="https://github.com">GitHub</a> – <a href="https://docs.github.com/en/github/site-policy/github-privacy-statement#github-pages">Privacy Policy</a>.

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>